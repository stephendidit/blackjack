<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml" lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />

<title>Blackjack Attempt</title>
<!-- <link rel="stylesheet" type="text/css" href="css/bootstrap.min.css" /> -->
<!-- <link rel="stylesheet" type="text/css" href="css/main.css" /> -->
</head>
<body>

* 1. Build Deck // built as buildDeck()
* Create Dealer
* Create Player
* 2. Shuffle Deck // built as shuffle()
* 3. player Places Wager
  * wager = wager1
* 4. Deal one card to player (face up)
* 5. Deal one card to dealer (face down)
* 6. Deal one card to player (face up)
* 7. Deal one card to dealer (face up)

8. Player Plays Hands

* 9. def hit() // built as hit()
   * end

def play()
  hand_i = 1
  hands = [
    {
      number => hand_i,
      played => false,
      wager => wager
    }
  ]
  hands.each do |hand|
    while hand[0] == "unplayed"
      options = ["stay", "hit"]
      if 2 identical cards
        options << split
      end
      if first play
        options << double
      end
      case options
      when "stay"
        hand[0] = "played"
      when "hit"
        hit() // this doesn't exist for player yet
        hand[0] = "played" if hand > 21
      when "split"
        hand_i += 1
        hands << {number => hand_i, played => false, wager => wager}
      when "double"
        hand[2] *= 2
      end // case options
    end // if hand unplayed
  end // hands each
end // def play



Dealer Hits Until Score of >= 17

Resolve Wagers
def resolve
  hands.each
    if hand == dealer
      push (player keeps original wager)
    else
      if hand <= 21
        if dealer > 21
          hand wins
        elsif hand > dealer
          hand wins
        elsif hand > player
          house wins
      elsif hand > 21
        house wins
      end
    end
  end
end

Discard Used Cards
Shuffle Remaining Cards and begin again


    <script src="https://code.jquery.com/jquery-2.2.3.min.js"></script>
    <script src="https://code.jquery.com/ui/1.11.4/jquery-ui.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/tether/1.3.2/js/tether.min.js"></script>
    <script src="https://cdn.rawgit.com/twbs/bootstrap/v4-dev/dist/js/bootstrap.js" crossorigin="anonymous"></script>
    <script src="https://use.fontawesome.com/343cc4bbfb.js"></script>
    <script>


    // GLOBAL //
    suitsArray = ['h','s','c','d'];
    valuesArray = [['a',1],[2,2],[3,3],[4,4],[5,5],[6,6],[7,7],[8,8],[9,9],[10,10],['j',10],['q',10],['k',10]];
    
    function totalHand(hand){ // total up a player's hand? or just the dealer's?
              // console.info(this.hands[n].hand)

      var totalValueOfHand = 0; // zero out the total
      var numberOfAcesInHand = 0; // zero out the number of aces...i think this is dealer's totaling, then.
      var CARD_VALUE_OFFSET = 1;
      hand.forEach(function(card){ // for each element in the dealer's hand
        // console.info(c)
        if (card[CARD_VALUE_OFFSET] == 1) {
          numberOfAcesInHand += 1; // add 1 to the number of aces we're counting
        } else { // but if it's not an ace...
          totalValueOfHand += card[CARD_VALUE_OFFSET]; // then add the card to the total
        }
      });

      while (numberOfAcesInHand > 0){ // while there's more than 0 aces
        if ((totalValueOfHand + 11) > 21){ // if the total + 11 goes over 21
          totalValueOfHand +=1; // then the ace needs to be treated as a 1
        } else { // otherwise
          totalValueOfHand += 11; // treat it as an 11
        }
        numberOfAcesInHand--; // remove one ace from the count
      }

      return totalValueOfHand

    }


    // DECK //
    


    function Deck(){
      console.log("New deck.");
      this.cards = [];

      this.build = function(requestedNumberOfDecks){
        var ValuesArrayFaceOffset = 0;
        var ValuesArrayFaceValueOffset = 1;
        var numberOfDecksBuilt = 0
        var cardsArrayOffset = 0

        while (numberOfDecksBuilt < requestedNumberOfDecks){          
          suitsArray.forEach(function (suit){ // for each symbol
            valuesArray.forEach(function(value){ // for each value
              
              // I'D RATHER THE NEXT LINES BEGIN W/ this.cards, BUT THAT PRODUCES AN ERROR THAT DECK.CARDS IS UNDEFINED. WHY?
              deck.cards[cardsArrayOffset] = []; // make an element that's also an array for the new card, in the position of the current index
              deck.cards[cardsArrayOffset][0] = suit + value[ValuesArrayFaceOffset]; // the the new element/array's first element = symbol + value[0]
              deck.cards[cardsArrayOffset][1] = value[ValuesArrayFaceValueOffset]; // the new element/array's second element = value[1]
              cardsArrayOffset++; // increase the index
            });
          });
          numberOfDecksBuilt++;
        }
        console.log("Deck built.")
      } // end build

      this.shuffle = function(){ // https://github.com/coolaj86/knuth-shuffle , http://stackoverflow.com/questions/2450954/how-to-randomize-shuffle-a-javascript-array
      
        var currentIndex = this.cards.length, temporaryValue, randomIndex;
        // While there remain elements to shuffle...
        while (0 !== currentIndex) {

          // Pick a remaining element...
          randomIndex = Math.floor(Math.random() * currentIndex);
          currentIndex -= 1;

          // And swap it with the current element.
          temporaryValue = this.cards[currentIndex];
          this.cards[currentIndex] = this.cards[randomIndex];
          this.cards[randomIndex] = temporaryValue;
        } // end while
        console.log("Shuffled deck.")
      } // end shuffle

      this.hit = function(){
        this.shuffle();
        return this.cards.pop();
      }

    } // end Deck

    // DEALER //

    function Dealer(){
      this.hand = [];

      this.draw = function(){
        this.hand.push( deck.hit() );
      }
    }

    function Player(){
      // this.hand = [];
      this.wager = 25;
      this.allThisPlayersHands = 0; // this will increase if player splits.

      this.draw = function(whichHandNumber){
        this.hands[whichHandNumber]['hand'].push( deck.hit() );
        console.log("just drew");
      }

      this.hands = {
          1: {
            hand: [],
            played: false
          }
        }
      this.play = function(){ // this is for the user to play his hand
        for (var n in this.hands){ // for each hand, since the user may have more than one

          this.hands[n].totalValue = totalHand(this.hands[n].hand);
          console.log("pre-while Hand value: " + this.hands[n].totalValue);
          var firstRoundOfDecisionMakingForPlayer = true;
          while (!this.hands[n]['played']){ // 
            
            var options = [];
        //     if ("2 identical cards"){
        //       options << "split";
        //     }  
            if (firstRoundOfDecisionMakingForPlayer == true){
              options.push("double","stay","hit");
              firstRoundOfDecisionMakingForPlayer = false;
            } else {
              options.push("stay","hit");
            }
            var move = window.prompt("for hand " + n + " " + options);
            switch(move){
              case "stay":
                this.hands[n].played = true;
                break;
              case "hit":
                me.draw(n);
                this.hands[n].totalValue = totalHand(this.hands[n].hand);
                if (this.hands[n].totalValue > 21){
                  this.hands[n].played = true;
                  console.log("BUST!")
                }
                break;
              case "split":
                me.allThisPlayersHands += 1;
                // alert(n)
                this.hands[n + 1].push( {hand:[], played: false} );
                console.log(me.hands);
                // I NEED TO ADD IN THE DRAW FUNCTIONS FOR THIS!!!!
                console.log("begin play again...");
                me.play();
                break;
              case "double":
                this.hands[n].wager *= 2;
                me.draw();
                this.hands[n].totalValue = totalHand(hand);
                break;
              default:
                console.log("QUIT");
                this.hands[n].played = true;
                break;
            } // switch
            this.hands[n].totalValue = totalHand(this.hands[n].hand);
            console.log("post-move/inside while Hand value: " + this.hands[n].totalValue);

            // alert(hand.totalValue);
          }  // while hand unplayed
          console.log("out of the while loop now");
        }; // hands each
      } // def play
    }

    // GET USER PREFS //

    howManyDecks = 1


    // TESTS

    deck = new Deck();
    deck.build(howManyDecks);

    // card = deck.hit(deck.cards);
    // console.log(card);

    var myDealer = new Dealer();

    var me = new Player();

    myDealer.draw();
    me.draw(1);
    myDealer.draw(); // this one would be face down
    me.draw(1);

    me.play();

    // myDealer.draw();

    // console.log("Dealer hand:");
    // console.log(myDealer.hand);

    // console.log("My hand:");
    // console.log(me.hands[0]);
    




    </script>



    // if (player instanceOf Dealer){
//      sum it up using dealer rules...
  //  } else {
    //  we know it's a player, so do that instead...
    //}


    // dealer_hand = [["c10",10],["a",1],["c10",10]]

    


    var sometotal = 0 // who knows what this var is?

    

    console.log(sometotal); // should begin as 0, i guess....
    while (sometotal <= 17) { // if sometotal is less than 17...sometotal should be the more like myDealer.total
      dealerDraw(); // draw again
      total(myDealer.dealer_hand); // and re-total the hand
    }
    console.log("finally is..." + total(myDealer.dealer_hand));
    console.log("the hand is..." + String(myDealer.dealer_hand))

</body>
</html>